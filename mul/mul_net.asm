    name Mul8          ; module name

    ;-------------------
    ;mul8
    ;r0*r1をr1:r0に格納する
    ;r0,r1,r2,r3を使用
mul8:
    ; x : r0 
    ; y : r1

    strz r2

    subz r1
    tpsl 01b
    bctr,eq _m8_not_swap
    eori,r0 255
    addi,r0 1   
    strz r3     ;r3 = r0 = y-x
    addz r2
    addz r2
    bctr,un _m8_
    
_m8_not_swap:
    strz r3 ; r3 = x-y
    addz r1
    addz r1
_m8_:
    strz r2 ; r2 = x + y

    tpsl 01b
    bctr,eq _m8_greater255

    loda,r0 mul_table0_hi,r2
    suba,r0 mul_table0_hi,r3
    strz r1

    loda,r0 mul_table0_lo,r2
    suba,r0 mul_table0_lo,r3

    tpsl 001b
    retc,eq     ;減算による桁溢れなしならreturn
    subi,r1 1
    retc,un

_m8_greater255:
    
    loda,r0 mul_table256_hi,r2
    suba,r0 mul_table0_hi,r3
    strz r1

    loda,r0 mul_table256_lo,r2
    suba,r0 mul_table0_lo,r3

    tpsl 001b
    retc,eq     ;減算による桁溢れなしならreturn
    subi,r1 1
    retc,un

mul_table0_hi:
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 0
    db 1
    db 1
    db 1
    db 1
    db 1
    db 1
    db 1
    db 1
    db 1
    db 1
    db 1
    db 1
    db 1
    db 1
    db 2
    db 2
    db 2
    db 2
    db 2
    db 2
    db 2
    db 2
    db 2
    db 2
    db 3
    db 3
    db 3
    db 3
    db 3
    db 3
    db 3
    db 3
    db 4
    db 4
    db 4
    db 4
    db 4
    db 4
    db 4
    db 4
    db 5
    db 5
    db 5
    db 5
    db 5
    db 5
    db 5
    db 6
    db 6
    db 6
    db 6
    db 6
    db 6
    db 7
    db 7
    db 7
    db 7
    db 7
    db 7
    db 8
    db 8
    db 8
    db 8
    db 8
    db 9
    db 9
    db 9
    db 9
    db 9
    db 9
    db 10
    db 10
    db 10
    db 10
    db 10
    db 11
    db 11
    db 11
    db 11
    db 12
    db 12
    db 12
    db 12
    db 12
    db 13
    db 13
    db 13
    db 13
    db 14
    db 14
    db 14
    db 14
    db 15
    db 15
    db 15
    db 15
    db 16
    db 16
    db 16
    db 16
    db 17
    db 17
    db 17
    db 17
    db 18
    db 18
    db 18
    db 18
    db 19
    db 19
    db 19
    db 19
    db 20
    db 20
    db 20
    db 21
    db 21
    db 21
    db 21
    db 22
    db 22
    db 22
    db 23
    db 23
    db 23
    db 24
    db 24
    db 24
    db 25
    db 25
    db 25
    db 25
    db 26
    db 26
    db 26
    db 27
    db 27
    db 27
    db 28
    db 28
    db 28
    db 29
    db 29
    db 29
    db 30
    db 30
    db 30
    db 31
    db 31
    db 31
    db 32
    db 32
    db 33
    db 33
    db 33
    db 34
    db 34
    db 34
    db 35
    db 35
    db 36
    db 36
    db 36
    db 37
    db 37
    db 37
    db 38
    db 38
    db 39
    db 39
    db 39
    db 40
    db 40
    db 41
    db 41
    db 41
    db 42
    db 42
    db 43
    db 43
    db 43
    db 44
    db 44
    db 45
    db 45
    db 45
    db 46
    db 46
    db 47
    db 47
    db 48
    db 48
    db 49
    db 49
    db 49
    db 50
    db 50
    db 51
    db 51
    db 52
    db 52
    db 53
    db 53
    db 53
    db 54
    db 54
    db 55
    db 55
    db 56
    db 56
    db 57
    db 57
    db 58
    db 58
    db 59
    db 59
    db 60
    db 60
    db 61
    db 61
    db 62
    db 62
    db 63
    db 63
mul_table0_lo:
    db 0
    db 0
    db 1
    db 2
    db 4
    db 6
    db 9
    db 12
    db 16
    db 20
    db 25
    db 30
    db 36
    db 42
    db 49
    db 56
    db 64
    db 72
    db 81
    db 90
    db 100
    db 110
    db 121
    db 132
    db 144
    db 156
    db 169
    db 182
    db 196
    db 210
    db 225
    db 240
    db 0
    db 16
    db 33
    db 50
    db 68
    db 86
    db 105
    db 124
    db 144
    db 164
    db 185
    db 206
    db 228
    db 250
    db 17
    db 40
    db 64
    db 88
    db 113
    db 138
    db 164
    db 190
    db 217
    db 244
    db 16
    db 44
    db 73
    db 102
    db 132
    db 162
    db 193
    db 224
    db 0
    db 32
    db 65
    db 98
    db 132
    db 166
    db 201
    db 236
    db 16
    db 52
    db 89
    db 126
    db 164
    db 202
    db 241
    db 24
    db 64
    db 104
    db 145
    db 186
    db 228
    db 14
    db 57
    db 100
    db 144
    db 188
    db 233
    db 22
    db 68
    db 114
    db 161
    db 208
    db 0
    db 48
    db 97
    db 146
    db 196
    db 246
    db 41
    db 92
    db 144
    db 196
    db 249
    db 46
    db 100
    db 154
    db 209
    db 8
    db 64
    db 120
    db 177
    db 234
    db 36
    db 94
    db 153
    db 212
    db 16
    db 76
    db 137
    db 198
    db 4
    db 66
    db 129
    db 192
    db 0
    db 64
    db 129
    db 194
    db 4
    db 70
    db 137
    db 204
    db 16
    db 84
    db 153
    db 222
    db 36
    db 106
    db 177
    db 248
    db 64
    db 136
    db 209
    db 26
    db 100
    db 174
    db 249
    db 68
    db 144
    db 220
    db 41
    db 118
    db 196
    db 18
    db 97
    db 176
    db 0
    db 80
    db 161
    db 242
    db 68
    db 150
    db 233
    db 60
    db 144
    db 228
    db 57
    db 142
    db 228
    db 58
    db 145
    db 232
    db 64
    db 152
    db 241
    db 74
    db 164
    db 254
    db 89
    db 180
    db 16
    db 108
    db 201
    db 38
    db 132
    db 226
    db 65
    db 160
    db 0
    db 96
    db 193
    db 34
    db 132
    db 230
    db 73
    db 172
    db 16
    db 116
    db 217
    db 62
    db 164
    db 10
    db 113
    db 216
    db 64
    db 168
    db 17
    db 122
    db 228
    db 78
    db 185
    db 36
    db 144
    db 252
    db 105
    db 214
    db 68
    db 178
    db 33
    db 144
    db 0
    db 112
    db 225
    db 82
    db 196
    db 54
    db 169
    db 28
    db 144
    db 4
    db 121
    db 238
    db 100
    db 218
    db 81
    db 200
    db 64
    db 184
    db 49
    db 170
    db 36
    db 158
    db 25
    db 148
    db 16
    db 140
    db 9
    db 134
    db 4
    db 130
    db 1
    db 128
mul_table256_hi:
    db 64
    db 64
    db 65
    db 65
    db 66
    db 66
    db 67
    db 67
    db 68
    db 68
    db 69
    db 69
    db 70
    db 70
    db 71
    db 71
    db 72
    db 72
    db 73
    db 73
    db 74
    db 74
    db 75
    db 76
    db 76
    db 77
    db 77
    db 78
    db 78
    db 79
    db 79
    db 80
    db 81
    db 81
    db 82
    db 82
    db 83
    db 83
    db 84
    db 84
    db 85
    db 86
    db 86
    db 87
    db 87
    db 88
    db 89
    db 89
    db 90
    db 90
    db 91
    db 92
    db 92
    db 93
    db 93
    db 94
    db 95
    db 95
    db 96
    db 96
    db 97
    db 98
    db 98
    db 99
    db 100
    db 100
    db 101
    db 101
    db 102
    db 103
    db 103
    db 104
    db 105
    db 105
    db 106
    db 106
    db 107
    db 108
    db 108
    db 109
    db 110
    db 110
    db 111
    db 112
    db 112
    db 113
    db 114
    db 114
    db 115
    db 116
    db 116
    db 117
    db 118
    db 118
    db 119
    db 120
    db 121
    db 121
    db 122
    db 123
    db 123
    db 124
    db 125
    db 125
    db 126
    db 127
    db 127
    db 128
    db 129
    db 130
    db 130
    db 131
    db 132
    db 132
    db 133
    db 134
    db 135
    db 135
    db 136
    db 137
    db 138
    db 138
    db 139
    db 140
    db 141
    db 141
    db 142
    db 143
    db 144
    db 144
    db 145
    db 146
    db 147
    db 147
    db 148
    db 149
    db 150
    db 150
    db 151
    db 152
    db 153
    db 153
    db 154
    db 155
    db 156
    db 157
    db 157
    db 158
    db 159
    db 160
    db 160
    db 161
    db 162
    db 163
    db 164
    db 164
    db 165
    db 166
    db 167
    db 168
    db 169
    db 169
    db 170
    db 171
    db 172
    db 173
    db 173
    db 174
    db 175
    db 176
    db 177
    db 178
    db 178
    db 179
    db 180
    db 181
    db 182
    db 183
    db 183
    db 184
    db 185
    db 186
    db 187
    db 188
    db 189
    db 189
    db 190
    db 191
    db 192
    db 193
    db 194
    db 195
    db 196
    db 196
    db 197
    db 198
    db 199
    db 200
    db 201
    db 202
    db 203
    db 203
    db 204
    db 205
    db 206
    db 207
    db 208
    db 209
    db 210
    db 211
    db 212
    db 212
    db 213
    db 214
    db 215
    db 216
    db 217
    db 218
    db 219
    db 220
    db 221
    db 222
    db 223
    db 224
    db 225
    db 225
    db 226
    db 227
    db 228
    db 229
    db 230
    db 231
    db 232
    db 233
    db 234
    db 235
    db 236
    db 237
    db 238
    db 239
    db 240
    db 241
    db 242
    db 243
    db 244
    db 245
    db 246
    db 247
    db 248
    db 249
    db 250
    db 251
    db 252
    db 253
    db 254
mul_table256_lo:
    db 0
    db 128
    db 1
    db 130
    db 4
    db 134
    db 9
    db 140
    db 16
    db 148
    db 25
    db 158
    db 36
    db 170
    db 49
    db 184
    db 64
    db 200
    db 81
    db 218
    db 100
    db 238
    db 121
    db 4
    db 144
    db 28
    db 169
    db 54
    db 196
    db 82
    db 225
    db 112
    db 0
    db 144
    db 33
    db 178
    db 68
    db 214
    db 105
    db 252
    db 144
    db 36
    db 185
    db 78
    db 228
    db 122
    db 17
    db 168
    db 64
    db 216
    db 113
    db 10
    db 164
    db 62
    db 217
    db 116
    db 16
    db 172
    db 73
    db 230
    db 132
    db 34
    db 193
    db 96
    db 0
    db 160
    db 65
    db 226
    db 132
    db 38
    db 201
    db 108
    db 16
    db 180
    db 89
    db 254
    db 164
    db 74
    db 241
    db 152
    db 64
    db 232
    db 145
    db 58
    db 228
    db 142
    db 57
    db 228
    db 144
    db 60
    db 233
    db 150
    db 68
    db 242
    db 161
    db 80
    db 0
    db 176
    db 97
    db 18
    db 196
    db 118
    db 41
    db 220
    db 144
    db 68
    db 249
    db 174
    db 100
    db 26
    db 209
    db 136
    db 64
    db 248
    db 177
    db 106
    db 36
    db 222
    db 153
    db 84
    db 16
    db 204
    db 137
    db 70
    db 4
    db 194
    db 129
    db 64
    db 0
    db 192
    db 129
    db 66
    db 4
    db 198
    db 137
    db 76
    db 16
    db 212
    db 153
    db 94
    db 36
    db 234
    db 177
    db 120
    db 64
    db 8
    db 209
    db 154
    db 100
    db 46
    db 249
    db 196
    db 144
    db 92
    db 41
    db 246
    db 196
    db 146
    db 97
    db 48
    db 0
    db 208
    db 161
    db 114
    db 68
    db 22
    db 233
    db 188
    db 144
    db 100
    db 57
    db 14
    db 228
    db 186
    db 145
    db 104
    db 64
    db 24
    db 241
    db 202
    db 164
    db 126
    db 89
    db 52
    db 16
    db 236
    db 201
    db 166
    db 132
    db 98
    db 65
    db 32
    db 0
    db 224
    db 193
    db 162
    db 132
    db 102
    db 73
    db 44
    db 16
    db 244
    db 217
    db 190
    db 164
    db 138
    db 113
    db 88
    db 64
    db 40
    db 17
    db 250
    db 228
    db 206
    db 185
    db 164
    db 144
    db 124
    db 105
    db 86
    db 68
    db 50
    db 33
    db 16
    db 0
    db 240
    db 225
    db 210
    db 196
    db 182
    db 169
    db 156
    db 144
    db 132
    db 121
    db 110
    db 100
    db 90
    db 81
    db 72
    db 64
    db 56
    db 49
    db 42
    db 36
    db 30
    db 25
    db 20
    db 16
    db 12
    db 9
    db 6
    db 4
    db 2
    db 1
    
end ; End of assembly
